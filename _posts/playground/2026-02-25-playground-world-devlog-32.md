---
layout: post
title: "Playground Devlog #32 - μΈνΈλ΅ μΉ΄λ©”λΌ μ™„μ„±: NPCκ°€ μ‚΄μ•„μλ” μ²«μΈμƒ"
date: 2026-02-25 23:00:00 +0900
categories: [playground, devlog]
tags: [intro-camera, npc-conversation, audio, ambient, ux]
---

"μ²« 30μ΄"λ¥Ό λ§λ“λ” λ° μ§‘μ¤‘ν• μ„Έμ…. μΈνΈλ΅ μΉ΄λ©”λΌκ°€ NPCλ¥Ό λ³΄μ—¬μ£Όλ©΄μ„ μ‚΄μ•„μλ” λ§μ„μ„ μ—°μ¶ν•©λ‹λ‹¤.

## μΈνΈλ΅ μΉ΄λ©”λΌ μ§„ν™” κ³Όμ •

μ΄ 6λ² λ°λ³µν–μµλ‹λ‹¤.

| λ²„μ „ | λ¬Έμ  |
|---|---|
| v1: μ‚¬μΈν ν¨λ‹ + μ¤μ•„μ›ƒ | λ°‹λ°‹ν•¨, NPC μ• λ³΄μ„ |
| v2: NPC 4λ… μν | μ¤μ•„μ›ƒμ΄λΌ μ „μ²΄λ§ λ³΄μ„ |
| v3: μ¤μΈ 1.15x | μ—¬μ „ν NPCμ— ν¬μ»¤μ¤ μ• λ¨ |
| v4: μ¤μΈ 1.8x | λ‚΄ μΊλ¦­ν„°λ§ ν¬κ² λ³΄μ„ |
| v5: ν”λ μ΄μ–΄ μ„μΉλ¥Ό NPCλ΅ μ΄λ™ | ν”λ μ΄μ–΄κ°€ ν…”λ ν¬νΈ |
| **v6: κ°€μƒ μΉ΄λ©”λΌ μ„μΉ** | ν”λ μ΄μ–΄ κ³ μ •, μΉ΄λ©”λΌλ§ μ΄λ™ |

### μµμΆ… κµ¬μ΅°

```
ν”λ μ΄μ–΄: (20, 25)μ— κ³ μ • β€” μ• μ›€μ§μ„
intraCamPos: κ°€μƒ μΉ΄λ©”λΌ μ„μΉ β€” NPCλ¥Ό μν
renderer._cameraFollowTarget: intraCamPos (μΈνΈλ΅ μ¤‘λ§)
```

λ λ”λ¬κ°€ λ§¤ ν”„λ μ„ `_cameraFollowTarget || player`λ¥Ό λ”°λΌκ°€λ―€λ΅, μΈνΈλ΅ μ¤‘μ—λ” κ°€μƒ μ„μΉλ¥Ό, μΈνΈλ΅ ν›„μ—λ” ν”λ μ΄μ–΄λ¥Ό λ”°λΌκ°‘λ‹λ‹¤.

### μΈνΈλ΅ μ‹ν€€μ¤

```
NPC1: νΌμ£λ§ μ¤‘μ–Όκ±°λ¦¬λ” λ¨μµ (2.5μ΄, μ¤μΈ)
  β†“
NPCμ: λ‘ NPCκ°€ λ€ν™”ν•λ” λ¨μµ (2.5μ΄, μ¤μΈ)
  β†“
NPC2: νΌμ£λ§ μ¤‘μ–Όκ±°λ¦¬λ” λ¨μµ (2.5μ΄, μ¤μΈ)
  β†“
μΉ΄λ©”λΌκ°€ ν”λ μ΄μ–΄ μ„μΉλ΅ λ¶€λ“λ½κ² λ³µκ·€
```

μΉ΄λ©”λΌκ°€ λΉ„μ¶”λ” NPCμ—κ² LLM νΌμ£λ§/λ€ν™”λ¥Ό νΈλ¦¬κ±°ν•©λ‹λ‹¤. `triggerIntroSpeech()`κ°€ νƒ€κ²μ΄ λ°”λ€” λ• 1νλ§ νΈμ¶.

## NPCκ°„ λ€ν™” λΉλ„

### Before
```js
nextSocialAt = world.totalMinutes + 22 + Math.random() * 34;
// 22~56λ¶„λ§λ‹¤ β€” μ‚¬μ‹¤μƒ μ• μΌμ–΄λ‚¨
```

### After
```js
nextSocialAt = now + 10000 + Math.random() * 15000;
// 10~25μ΄λ§λ‹¤ β€” νΌμ£λ§(8~20μ΄)κ³Ό λΉ„μ·
```

κ°€μ¥ κ°€κΉμ΄ NPC μμ„ μ°Ύμ•„μ„ λ€ν™”μ‹ν‚µλ‹λ‹¤. 6νƒ€μΌ μ΄λ‚΄λ©΄ μ„λ΅ κ±Έμ–΄κ°€κ².

## Rule-base νΌμ£λ§ β†’ μ΄λ¨ν‹°μ½λ§

```js
// Before
ambient_solo: ["πµ", "π¶", "~β™", "ν ν ", "ν›„~", "λΌλΌ~", "μ~"]
ambient_chat: ["γ…γ…", "μ™€~", "κ·Έλ?", "λ§μ•„", "μμ", "μ¤~", "ν—¤ν—¤"]

// After
ambient_solo: ["πµ", "π¶", "~β™", "π’­", "β¨"]
ambient_chat: ["π„", "π®", "π¤­", "π‘‹", "π’¬"]
```

LLMμ΄ μƒμ„±ν•λ” νΌμ£λ§(κ°€μ¥ κ°€κΉμ΄ NPC)μ€ μ—¬μ „ν ν…μ¤νΈ. λ‚λ¨Έμ§€λ” μ΄λ¨ν‹°μ½μΌλ΅ κΉ”λ”ν•κ².

## κ°™μ€ NPC μ—°μ† νΌμ£λ§ λ°©μ§€

`lastAmbientNpcId`λ¥Ό κΈ°μ–µν•΄μ„, μ§μ „κ³Ό κ°™μ€ NPCλ©΄ 2λ²μ§Έλ΅ κ°€κΉμ΄ NPC μ„ νƒ.

## μ¤λ””μ¤

Web Audio API β†’ HTML5 `<audio>` μ „ν™. μΉμ§€μ§/ν•μΈλ§ ν•΄κ²°.
BGMμ„ λ™λ¬Όμ μ² μ¤νƒ€μΌ νΈλ™μΌλ΅ κµμ²΄ (Pixabay: Chill Yume).

## ν•µμ‹¬

μΈνΈλ΅κ°€ λ³΄μ—¬μ£Όλ” κ²ƒ:

> μΉ΄λ©”λΌκ°€ λ§μ„μ„ λΉ„μ¶”λ©΄, NPCκ°€ νΌμ£λ§μ„ ν•κ³ , λ‹¤λ¥Έ NPCλΌλ¦¬ λ€ν™”ν•κ³  μλ‹¤.
> μ΄ λ§μ„μ€ λ‚΄κ°€ μ¤κΈ° μ „λ¶€ν„° μ‚΄μ•„μμ—λ‹¤.

κ·Έλ¦¬κ³  μΉ΄λ©”λΌκ°€ ν”λ μ΄μ–΄μ—κ² λμ•„μ¤λ©΄, μ μ§„μ΄ κ±Έμ–΄μ¤λ©° μΈμ‚¬ν•λ‹¤.

μ΄κ² "μ²« 30μ΄"μ…λ‹λ‹¤.
